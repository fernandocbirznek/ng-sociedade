<div fxLayout="column">
    <div fxLayout="row" fxLayoutAlign="space-between center">
        <div fxLayout="row" fxLayoutAlign="start center">
            <div class="g-dot-mecanica"></div>
            <div class="titulo">Mecânica</div>
        </div>
        <div fxLayout="row" fxLayoutAlign="center center" class="container-voltar" (click)="voltarPaginaMecanica()">
            <mat-icon class="material-symbols-outlined">undo</mat-icon>
            <span>Voltar</span>
        </div>
    </div>
    
    <div class="titulo-aula">{{ this.aula.titulo }}</div>

    <div fxLayout="column" fxLayoutAlign="center end">
        <div class="aula-autor" (click)="visualizarPerfil()">
            Nome do professor
        </div>
        <div class="aula-data-cadastro">{{ this.aula.dataCadastro | date : 'dd/MM/yyyy HH:mm' }}</div>
        <div fxLayout="row" fxLayoutAlign="space-between center" class="container-icones">
            <div fxLayout="row" fxLayoutAlign="space-between center" class="icone" (click)="curtirAula()">
                <mat-icon class="material-symbols-outlined">thumb_up</mat-icon>
                <div>{{ this.aula.curtido }}</div>
            </div>
            <div fxLayout="row" fxLayoutAlign="space-between center" class="icone" (click)="favoritarAula()">
                <mat-icon class="material-symbols-outlined">star</mat-icon>
                <div>{{ this.aula.favoritado }}</div>
            </div>
        </div>
    </div>

    <div *ngIf="this.usuarioLogado && this.usuarioLogado.tipoUsuario == 1" fxLayout="row" fxLayoutAlign="start center" 
        class="container-salvar-aula">
        <span>salvar em:</span>
        <div class="salvar-aula para-cursar" [ngClass]="{'para-cursar-selecionado': this.widgetCursar }" 
            (click)="cursar()">
            Para cursar
        </div>
        <div class="salvar-aula cursando"  [ngClass]="{'para-cursando-selecionado': this.widgetCursando }" 
            (click)="cursando()">
            Cursando
        </div>
        <div class="salvar-aula concluido" [ngClass]="{'para-concluido-selecionado': this.widgetConcluido }" 
            (click)="concluido()">
            Concluído
        </div>
    </div>
    
    <fieldset class="g-fieldset">
        <div class="g-fieldset-titulo">Resumo</div>
        <div>{{ this.aula.resumo }}</div>
    </fieldset>

    <div *ngFor="let sessao of this.aula.aulaSessaoMany; index as i" fxLayout="column" class="container-sessao-many">
        <div *ngIf="this.usuarioLogado && this.usuarioLogado.tipoUsuario != 0" class="salvar-sessao">
            <div *ngIf="!this.usuarioAulaSessaoFavoritado.includes(sessao.id)" (click)="salvarSessaoFavoritado(sessao)"
                matTooltip="Adicionar aos favoritos">
                <mat-icon class="material-symbols-outlined">bookmark_add</mat-icon>
            </div>
            <div *ngIf="this.usuarioAulaSessaoFavoritado.includes(sessao.id)" (click)="removerSessaoFavoritado(sessao)"
                matTooltip="Remover dos favoritos" class="sessao-favoritado">
                <mat-icon class="material-symbols-outlined">bookmark_added</mat-icon>
            </div>
        </div>
        <div fxLayout="column" fxLayoutAlign="center center" class="titulo-sessao">
            {{ sessao.titulo }}
        </div>
        <div *ngIf="sessao.aulaSessaoTipo == this.tipoSessaoAulaEnum.Conceito || sessao.aulaSessaoTipo == this.tipoSessaoAulaEnum.Texto" 
            fxLayout="column" fxLayoutAlign="center center" [innerHTML]="this.trustedVisualizarAulaHtml[i]">
        </div>
        <div *ngIf="sessao.aulaSessaoTipo == this.tipoSessaoAulaEnum.Equacao"> 
            <ng-katex [equation]="sessao.conteudo"></ng-katex>
        </div>
        <div *ngIf="sessao.aulaSessaoTipo == this.tipoSessaoAulaEnum.Imagem">
            <img fxFlex="100%" [src]="this.trustedUrlImageHtml[i]" alt="Imagem" class="imagem">
        </div>
    </div>
    <div fxLayout="column" class="container-comentario-cards">
        <div class="text-comentarios">Comentários</div>
        <div *ngIf="this.usuarioLogado && this.usuarioLogado.tipoUsuario != 0 && !escreverComentario" fxLayout="column" 
            class="button-comentario" (click)="comentar()">
            Escrever comentário
        </div>
        <div *ngIf="this.usuarioLogado && this.usuarioLogado.tipoUsuario != 0 && escreverComentario" fxLayout="column">
            <form [formGroup]="this.formComentario" fxLayout="column" fxLayoutAlign="center center" class="g-full-width">
                <ckeditor formControlName="comentario" class="ckeditor-comentario" #ckEditorTag [editor]="ckEditor" 
                    data="<p>Escreva o comentário</p>">
                </ckeditor>
            </form>

            <div fxLayout="row" fxLayoutAlign="space-around center" class="container-buttons">
                <button mat-stroked-button color="accent" (click)="cancelarComentario()">Cancelar</button>
                <button mat-stroked-button color="primary" (click)="cadastrarComentario()">Comentar</button>
            </div>
        </div>
        <div fxLayout="row wrap" class="g-gap-20">
            <div *ngFor="let aulaComentario of  this.aulaComentarioMany; index as i" fxLayout="row wrap" 
                class="container-comentario-many">
                <div fxLayout="row" fxLayoutAlign="space-between start" class="container-comentario">
                    <div class="comentario-data-cadastro">
                        {{ aulaComentario.dataCadastro | date : 'dd/MM/yyyy HH:mm' }}
                    </div>
                    <div fxFlex="100px" fxLayout="column" fxLayoutAlign="space-between center" class="usuario-perfil">
                        <div *ngIf="this.usuarioLogado && this.usuarioLogado.id == this.aulaComentario.usuarioId"  
                            fxLayout="row" fxLayoutAlign="space-around center" class="container-comentario-buttons">
                            <mat-icon class="icone-delete material-symbols-outlined" (click)="excluirComentario(aulaComentario)"
                                matTooltip="Excluir comentário">
                                delete
                            </mat-icon>
                            <mat-icon class="icone-edit material-symbols-outlined" (click)="editarComentario(aulaComentario)"
                                matTooltip="Editar comentário">
                                edit_square
                            </mat-icon>
                        </div>
                        <div fxFlex="100%">FOTO</div>
                        <div>Nome</div>
                    </div>
                    <div fxFlex="1px" class="divisoria"></div>
                    <div fxFlex="100%" fxLayout="column" fxLayoutAlign="start center" class="comentario"
                        [innerHTML]="this.trustedAulaComentarioHtml[i]">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
    